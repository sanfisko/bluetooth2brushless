# üöó –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ—Ç–æ—Ä–æ–º - ESP32 + BT13

## üéØ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!

**–ë—ã–ª–æ**: ESP32 –ø–æ–¥–∫–ª—é—á–∞–ª—Å—è –∫ BT13, –Ω–æ –Ω–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫–∏ –ø—É–ª—å—Ç–∞  
**–°—Ç–∞–ª–æ**: –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ—Ç–æ—Ä–æ–º —á–µ—Ä–µ–∑ –≤—Å–µ –∫–Ω–æ–ø–∫–∏ BT13 ‚úÖ

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ HID –¥–∞–Ω–Ω—ã—Ö
–í —Ñ–∞–π–ª–µ `esp-idf-version/main/main.c` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `hid_host_cb()` –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ HID –∫–æ–º–∞–Ω–¥:

```c
case 2: // INPUT_EVENT
    // –ü–∞—Ä—Å–∏–Ω–≥ HID –¥–∞–Ω–Ω—ã—Ö
    esp_hidh_event_data_t *event_data = (esp_hidh_event_data_t *)param;
    if (event_data && event_data->input.data && event_data->input.length >= 3) {
        uint16_t usage = (event_data->input.data[2] << 8) | event_data->input.data[1];
        
        switch (usage) {
            case 0x00B5: short_press_plus(); break;    // –ö–æ—Ä–æ—Ç–∫–æ–µ +
            case 0x00B6: short_press_minus(); break;   // –ö–æ—Ä–æ—Ç–∫–æ–µ -
            case 0x00E9: long_press_plus(); break;     // –î–ª–∏–Ω–Ω–æ–µ +
            case 0x00EA: long_press_minus(); break;    // –î–ª–∏–Ω–Ω–æ–µ -
            case 0x00CD: motor_stop(); break;          // –°—Ä–µ–¥–Ω—è—è –∫–Ω–æ–ø–∫–∞
        }
    }
```

### 2. –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
–†–∞–Ω–µ–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å –∞–∫—Ç–∏–≤–Ω–æ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è:
- `short_press_plus()` - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –Ω–∞ 1
- `short_press_minus()` - —É–º–µ–Ω—å—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –Ω–∞ 1  
- `long_press_plus()` - –º–∞–∫—Å–∏–º—É–º –≤–ø–µ—Ä–µ–¥
- `long_press_minus()` - –º–∞–∫—Å–∏–º—É–º –Ω–∞–∑–∞–¥
- `motor_stop()` - –ø–æ–ª–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞

## üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ—Ç–æ—Ä–æ–º

### –ö–Ω–æ–ø–∫–∏ BT13:
| –ö–Ω–æ–ø–∫–∞ | –î–µ–π—Å—Ç–≤–∏–µ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|--------|----------|-----------|
| **+ –∫–æ—Ä–æ—Ç–∫–æ–µ** | –£–≤–µ–ª–∏—á–µ–Ω–∏–µ | –£—Ä–æ–≤–µ–Ω—å +1 (–¥–æ 10) |
| **- –∫–æ—Ä–æ—Ç–∫–æ–µ** | –£–º–µ–Ω—å—à–µ–Ω–∏–µ | –£—Ä–æ–≤–µ–Ω—å -1 (–¥–æ -10) |
| **+ –¥–ª–∏–Ω–Ω–æ–µ** | –ú–∞–∫—Å–∏–º—É–º | –£—Ä–æ–≤–µ–Ω—å = 10 (–≤–ø–µ—Ä–µ–¥) |
| **- –¥–ª–∏–Ω–Ω–æ–µ** | –ú–∞–∫—Å–∏–º—É–º | –£—Ä–æ–≤–µ–Ω—å = -10 (–Ω–∞–∑–∞–¥) |
| **–°—Ä–µ–¥–Ω—è—è** | –°—Ç–æ–ø | –£—Ä–æ–≤–µ–Ω—å = 0 (–æ—Å—Ç–∞–Ω–æ–≤–∫–∞) |

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:
- **–£—Ä–æ–≤–Ω–∏**: –æ—Ç -10 (–Ω–∞–∑–∞–¥) –¥–æ +10 (–≤–ø–µ—Ä–µ–¥)
- **PWM**: 25 –µ–¥–∏–Ω–∏—Ü –Ω–∞ —É—Ä–æ–≤–µ–Ω—å (255 –º–∞–∫—Å–∏–º—É–º)
- **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: GPIO26 (1=–≤–ø–µ—Ä–µ–¥, 0=–Ω–∞–∑–∞–¥)
- **–°–∫–æ—Ä–æ—Å—Ç—å**: GPIO25 (PWM —Å–∏–≥–Ω–∞–ª)

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏

### –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏:
```
I (40403) BT13_MOTOR_CONTROL: BT13 –ø–æ–¥–∫–ª—é—á–µ–Ω —É—Å–ø–µ—à–Ω–æ!
I (40403) BT13_MOTOR_CONTROL: –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∫–æ–º–∞–Ω–¥ –æ—Ç –ø—É–ª—å—Ç–∞
```

### –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–æ–∫:
```
I (106173) BT13_MOTOR_CONTROL: –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ—Ç BT13
I (106173) BT13_MOTOR_CONTROL: HID –¥–∞–Ω–Ω—ã–µ (3 –±–∞–π—Ç):
01 B5 00 
I (106173) BT13_MOTOR_CONTROL: HID Usage: 0x00B5
I (106173) BT13_MOTOR_CONTROL: –ö–æ–º–∞–Ω–¥–∞: –ö–æ—Ä–æ—Ç–∫–æ–µ + (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è)
I (106173) BT13_MOTOR_CONTROL: –ö–æ—Ä–æ—Ç–∫–æ–µ +: –£—Ä–æ–≤–µ–Ω—å —Å–∫–æ—Ä–æ—Å—Ç–∏ = 1
I (106173) BT13_MOTOR_CONTROL: –°–æ—Å—Ç–æ—è–Ω–∏–µ: –í–ö–õ | –£—Ä–æ–≤–µ–Ω—å: 1/10 | PWM: 25/255 | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –í–ü–ï–†–ï–î
```

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

### 1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
–ö–æ–¥ —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –≤ —Ñ–∞–π–ª–µ `esp-idf-version/main/main.c`

### 2. –°–æ–±—Ä–∞—Ç—å –∏ –ø—Ä–æ—à–∏—Ç—å
```bash
cd esp-idf-version
. ~/esp/esp-idf/export.sh  # –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å ESP-IDF
idf.py build flash
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
idf.py monitor
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –í–∫–ª—é—á–∏—Ç—å BT13 (–¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
2. –ù–∞–∂–∏–º–∞—Ç—å –∫–Ω–æ–ø–∫–∏ –∏ –Ω–∞–±–ª—é–¥–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∞—Ö
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –º–æ—Ç–æ—Ä–∞ –Ω–∞ GPIO25/26

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ BT13
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –ø—É–ª—å—Ç–∞
- ‚úÖ –ü–ª–∞–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç—å—é (10 —É—Ä–æ–≤–Ω–µ–π)
- ‚úÖ –†–µ–≤–µ—Ä—Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏

**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ

---
**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 2025-06-09  
**–ê–≤—Ç–æ—Ä**: OpenHands AI  
**–í–µ—Ä—Å–∏—è**: ESP-IDF v5.4.1