# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è ID: 4

## üêõ –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ BT13 –ø—É–ª—å—Ç–∞ ESP32 –ø–æ–ª—É—á–∞–ª —Å–æ–±—ã—Ç–∏–µ —Å ID: 4, –Ω–æ —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–æ—Å—å –≤ callback —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª.

## üìä –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
–í –ª–æ–≥–∞—Ö –±—ã–ª–æ –≤–∏–¥–Ω–æ:
```
W (27173) BT_HCI: hcif disc complete: hdl 0x80, rsn 0x13
I (27183) BT13_MOTOR_CONTROL: HID Host —Å–æ–±—ã—Ç–∏–µ: ESP_HIDH_EVENTS (ID: 4)
I (27183) BT13_MOTOR_CONTROL: HID Host —Å–æ–±—ã—Ç–∏–µ: 4
```

–°–æ–±—ã—Ç–∏–µ ID: 4 –ø–æ–ø–∞–¥–∞–ª–æ –≤ `default` case –∏ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–æ —Ñ–ª–∞–≥ `restart_scan_needed`.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è ID: 4 –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è:

```c
case 4: // DISCONNECT_EVENT (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è)
    bt13_connected = false;
    ESP_LOGI(TAG, "BT13 –æ—Ç–∫–ª—é—á–µ–Ω (—Å–æ–±—ã—Ç–∏–µ 4). –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞...");
    motor_stop(); // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—å –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏
    led_blink(5, 100); // –ò–Ω–¥–∏–∫–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
    restart_scan_needed = true; // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
    break;
```

## üîÑ –£–ª—É—á—à–µ–Ω–Ω—ã–µ –ª–æ–≥–∏
–î–æ–±–∞–≤–ª–µ–Ω—ã —ç–º–æ–¥–∑–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –ª–æ–≥–æ–≤:
```c
ESP_LOGI(TAG, "üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ñ–ª–∞–≥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø–æ–∏—Å–∫–∞!");
ESP_LOGI(TAG, "‚è≥ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞ BT13 —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã...");
ESP_LOGI(TAG, "üîç –ó–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞ BT13...");
ESP_LOGI(TAG, "‚úÖ BT13 —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω, –æ—Ç–º–µ–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞");
```

## üìã –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd ~/bluetooth2brushless
git pull origin main

# 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd esp-idf-version

# 3. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å ESP-IDF
. ~/esp/esp-idf/export.sh

# 4. –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
idf.py build

# 5. –ü—Ä–æ—à–∏—Ç—å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å
idf.py -p /dev/ttyUSB0 flash monitor
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –ø—É–ª—å—Ç–∞:
```
I (xxx) BT13_MOTOR_CONTROL: BT13 –æ—Ç–∫–ª—é—á–µ–Ω (—Å–æ–±—ã—Ç–∏–µ 4). –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞...
I (xxx) BT13_MOTOR_CONTROL: üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ñ–ª–∞–≥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø–æ–∏—Å–∫–∞!
I (xxx) BT13_MOTOR_CONTROL: ‚è≥ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞ BT13 —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã...
I (xxx) BT13_MOTOR_CONTROL: üîç –ó–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞ BT13...
I (xxx) BT13_MOTOR_CONTROL: –ü–æ–∏—Å–∫ –ø—É–ª—å—Ç–∞ BT13 (MAC: 8B:EB:75:4E:65:97)...
I (xxx) BT13_MOTOR_CONTROL: –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞—á–∞—Ç
```

### –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤–∫–ª—é—á–µ–Ω–∏–∏ –ø—É–ª—å—Ç–∞:
```
I (xxx) BT13_MOTOR_CONTROL: –ù–∞–π–¥–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: 8b:eb:75:4e:65:97
I (xxx) BT13_MOTOR_CONTROL: –ù–∞–π–¥–µ–Ω BT13! –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–∏—Å–∫...
I (xxx) BT13_MOTOR_CONTROL: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ BT13...
I (xxx) BT13_MOTOR_CONTROL: BT13 –ø–æ–¥–∫–ª—é—á–µ–Ω —É—Å–ø–µ—à–Ω–æ!
I (xxx) BT13_MOTOR_CONTROL: –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É –∫–æ–º–∞–Ω–¥ –æ—Ç –ø—É–ª—å—Ç–∞
```

## üéØ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–ü—Ä–æ—à–µ–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é**
2. **–î–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ BT13**
3. **–í—ã–∫–ª—é—á–∏—Ç–µ –ø—É–ª—å—Ç BT13**
4. **–ù–∞–±–ª—é–¥–∞–π—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "BT13 –æ—Ç–∫–ª—é—á–µ–Ω (—Å–æ–±—ã—Ç–∏–µ 4)"**
5. **–ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –ø–æ–∏—Å–∫**
6. **–í–∫–ª—é—á–∏—Ç–µ –ø—É–ª—å—Ç BT13 –æ–±—Ä–∞—Ç–Ω–æ**
7. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**

## ‚úÖ –°—Ç–∞—Ç—É—Å
üü¢ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¢–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

---
*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è ID: 4 –¥–ª—è ESP-IDF v5.4.1*  
*–î–∞—Ç–∞: 2025-06-09*