╔══════════════════════════════════════════════════════════════════════════════════╗
║                        НАСТРОЙКИ ARDUINO IDE ДЛЯ ESP32                            ║
╚══════════════════════════════════════════════════════════════════════════════════╝

НАСТРОЙКИ ПЛАТЫ:
┌─────────────────────┬─────────────────────────────────────────────────────────────┐
│ Параметр            │ Значение                                                    │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Плата               │ ESP32 Dev Module                                           │
│ Upload Speed        │ 921600                                                      │
│ CPU Frequency       │ 240MHz (WiFi/BT)                                           │
│ Flash Frequency     │ 80MHz                                                       │
│ Flash Mode          │ QIO                                                         │
│ Flash Size          │ 4MB (32Mb)                                                  │
│ Partition Scheme    │ Default 4MB with spiffs (1.2MB APP/1.5MB SPIFFS)          │
│ Core Debug Level    │ None (для продакшена) / Info (для отладки)                 │
│ PSRAM               │ Disabled                                                    │
│ Arduino Runs On     │ Core 1                                                      │
│ Events Run On       │ Core 1                                                      │
└─────────────────────┴─────────────────────────────────────────────────────────────┘

ДОПОЛНИТЕЛЬНЫЕ URL МЕНЕДЖЕРОВ ПЛАТ:
https://espressif.github.io/arduino-esp32/package_esp32_index.json

ТРЕБУЕМЫЕ БИБЛИОТЕКИ:
┌─────────────────────┬─────────────┬─────────────────────────────────────────────────┐
│ Библиотека          │ Версия      │ Описание                                        │
├─────────────────────┼─────────────┼─────────────────────────────────────────────────┤
│ ESP32               │ 2.0.0+      │ Основной пакет ESP32 (включает BluetoothSerial)│
│ BluetoothSerial     │ Встроенная  │ Bluetooth Serial коммуникация                   │
│ WiFi                │ Встроенная  │ WiFi функциональность (для расширений)          │
│ WebServer           │ Встроенная  │ Web сервер (для расширений)                     │
│ Preferences         │ Встроенная  │ Сохранение настроек (для расширений)            │
└─────────────────────┴─────────────┴─────────────────────────────────────────────────┘

НАСТРОЙКИ КОМПИЛЯТОРА:
┌─────────────────────┬─────────────────────────────────────────────────────────────┐
│ Опция               │ Рекомендуемое значение                                      │
├─────────────────────┼─────────────────────────────────────────────────────────────┤
│ Compiler Warnings   │ Default                                                     │
│ Erase Flash         │ Only Sketch (для обновлений) / All Flash Contents (первый) │
│ Port                │ Автоматически определяется (COMx в Windows, /dev/ttyUSBx)  │
│ Programmer          │ Esptool                                                     │
└─────────────────────┴─────────────────────────────────────────────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════════╗
║                              ПОШАГОВАЯ НАСТРОЙКА                                  ║
╚══════════════════════════════════════════════════════════════════════════════════╝

1. УСТАНОВКА ARDUINO IDE:
   • Скачайте с https://www.arduino.cc/en/software
   • Установите версию 1.8.19 или новее (рекомендуется 2.x)

2. ДОБАВЛЕНИЕ ESP32:
   • Файл → Настройки → Дополнительные URL менеджеров плат
   • Добавьте URL выше
   • Инструменты → Плата → Менеджер плат
   • Найдите "ESP32" → Установите "ESP32 by Espressif Systems"

3. НАСТРОЙКА ПЛАТЫ:
   • Инструменты → Плата → ESP32 Arduino → ESP32 Dev Module
   • Установите параметры согласно таблице выше

4. ПОДКЛЮЧЕНИЕ ESP32:
   • Подключите ESP32 к USB
   • Инструменты → Порт → Выберите соответствующий порт
   • Если порт не определяется - установите драйверы CH340/CP2102

5. ЗАГРУЗКА КОДА:
   • Откройте bluetooth2brushless.ino
   • Нажмите "Проверить" (галочка)
   • Нажмите "Загрузить" (стрелка)

╔══════════════════════════════════════════════════════════════════════════════════╗
║                            УСТРАНЕНИЕ ПРОБЛЕМ                                     ║
╚══════════════════════════════════════════════════════════════════════════════════╝

ПРОБЛЕМА: "A fatal error occurred: Failed to connect to ESP32"
РЕШЕНИЕ:
• Нажмите и удерживайте кнопку BOOT на ESP32
• Нажмите кнопку "Загрузить" в Arduino IDE
• Отпустите BOOT когда начнется загрузка

ПРОБЛЕМА: "Compilation error: BluetoothSerial.h: No such file"
РЕШЕНИЕ:
• Убедитесь, что выбрана плата ESP32 (не Arduino)
• Обновите пакет ESP32 до версии 2.0.0+
• Перезапустите Arduino IDE

ПРОБЛЕМА: Порт не определяется
РЕШЕНИЕ:
• Установите драйверы:
  - Windows: CH340 или CP2102 драйверы
  - Linux: sudo usermod -a -G dialout $USER (перелогиньтесь)
  - macOS: Обычно работает без драйверов
• Попробуйте другой USB кабель
• Проверьте, что кабель поддерживает передачу данных

ПРОБЛЕМА: Ошибки памяти при компиляции
РЕШЕНИЕ:
• Измените Partition Scheme на "Huge APP (3MB No OTA/1MB SPIFFS)"
• Уменьшите Core Debug Level до "None"
• Закройте другие программы

╔══════════════════════════════════════════════════════════════════════════════════╗
║                              ПОЛЕЗНЫЕ КОМАНДЫ                                     ║
╚══════════════════════════════════════════════════════════════════════════════════╝

МОНИТОРИНГ:
• Инструменты → Монитор порта
• Скорость: 115200 бод
• Окончание строки: "Новая строка"

ОЧИСТКА FLASH:
• Инструменты → ESP32 Sketch Data Upload (если установлен плагин)
• Или используйте esptool.py: esptool.py --chip esp32 erase_flash

ПРОВЕРКА ПОДКЛЮЧЕНИЯ:
• В мониторе порта должны появиться сообщения инициализации
• Bluetooth устройство "ESP32_Motor_Control" должно быть видно

ОБНОВЛЕНИЕ ПРОШИВКИ:
• Просто загрузите новый скетч
• Настройки сохранятся (если используется Preferences)
• Для полной очистки используйте "Erase Flash: All Flash Contents"