# üéÆ –ê–Ω–∞–ª–∏–∑ HID –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –ø—É–ª—å—Ç–∞ BT13

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Ubuntu

### ‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- **MAC –∞–¥—Ä–µ—Å**: `8B:EB:75:4E:65:97`
- **–ò–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**: `BT13`
- **HID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ**: `/dev/input/event11`
- **Modalias**: `usb:v05ACp022Cd011B` (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ Apple —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)

### üéØ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –∫–Ω–æ–ø–æ–∫ BT13

| –î–µ–π—Å—Ç–≤–∏–µ | Linux Event | HID Usage Code | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –º–æ—Ç–æ—Ä–∞ |
|----------|-------------|----------------|----------------------|
| **–ü–ª—é—Å –∫–æ—Ä–æ—Ç–∫–æ–µ** | `KEY_NEXTSONG` (163) | `0x00B5` | +1 —É—Ä–æ–≤–µ–Ω—å —Å–∫–æ—Ä–æ—Å—Ç–∏ |
| **–ú–∏–Ω—É—Å –∫–æ—Ä–æ—Ç–∫–æ–µ** | `KEY_PREVIOUSSONG` (165) | `0x00B6` | -1 —É—Ä–æ–≤–µ–Ω—å —Å–∫–æ—Ä–æ—Å—Ç–∏ |
| **–°—Ä–µ–¥–Ω—è—è –∫–Ω–æ–ø–∫–∞** | `KEY_PLAYPAUSE` (164) | `0x00CD` | –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ |
| **–ü–ª—é—Å –¥–æ–ª–≥–æ–µ** | `KEY_VOLUMEUP` (115) | `0x00E9` | –ú–∞–∫—Å–∏–º—É–º –≤–ø–µ—Ä–µ–¥ |
| **–ú–∏–Ω—É—Å –¥–æ–ª–≥–æ–µ** | `KEY_VOLUMEDOWN` (114) | `0x00EA` | –ú–∞–∫—Å–∏–º—É–º –Ω–∞–∑–∞–¥ |

### üîç –í–∞–∂–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ
**BT13 —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∂–∞—Ç–∏–π!** –≠—Ç–æ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥ ESP32:
- –ö–æ—Ä–æ—Ç–∫–∏–µ –Ω–∞–∂–∞—Ç–∏—è ‚Üí NEXT/PREVIOUS –∫–æ–¥—ã
- –î–ª–∏–Ω–Ω—ã–µ –Ω–∞–∂–∞—Ç–∏—è ‚Üí VOLUME_UP/DOWN –∫–æ–¥—ã
- ESP32 –Ω–µ –Ω—É–∂–Ω–æ –∏–∑–º–µ—Ä—è—Ç—å –≤—Ä–µ–º—è –Ω–∞–∂–∞—Ç–∏–π

### üì° –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã

**–û—Å–Ω–æ–≤–Ω—ã–µ UUID —Å–µ—Ä–≤–∏—Å—ã:**
- `0000110d` - Advanced Audio Distribution Profile (A2DP)
- `0000110e` - Audio/Video Remote Control Profile (AVRCP)
- `0000110f` - AVRCP Controller
- `00001124` - Human Interface Device (HID)
- `00001200` - PnP Information

**–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:**
- **Class**: `0x00002540` (Input Device)
- **Icon**: `input-keyboard`
- **–ü—Ä–æ—Ç–æ–∫–æ–ª**: HID Consumer Control

## üîß –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ ESP32

### Arduino IDE –≤–µ—Ä—Å–∏—è
–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `processHIDEvent()` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ HID –∫–æ–¥–∞–º–∏:

```cpp
void processHIDEvent(uint16_t usage, bool pressed) {
  if (!pressed) return; // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–∂–∞—Ç–∏—è
  
  switch (usage) {
    case 0x00B5: // Next Song (–∫–æ—Ä–æ—Ç–∫–æ–µ +)
      shortPressPlus();
      break;
    case 0x00B6: // Previous Song (–∫–æ—Ä–æ—Ç–∫–æ–µ -)
      shortPressMinus();
      break;
    case 0x00E9: // Volume Up (–¥–ª–∏–Ω–Ω–æ–µ +)
      longPressPlus();
      break;
    case 0x00EA: // Volume Down (–¥–ª–∏–Ω–Ω–æ–µ -)
      longPressMinus();
      break;
    case 0x00CD: // Play/Pause (—Å—Ç–æ–ø)
      stopMotor();
      break;
  }
}
```

### ESP-IDF –≤–µ—Ä—Å–∏—è
–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `handle_hid_event()` —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ BT13.

## üéÆ –õ–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–≥–∞—Ç–µ–ª–µ–º

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –º–æ—Ç–æ—Ä–∞
- **Volume+**: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–∫–æ—Ä–æ—Ç–∫–æ–µ) / –ú–∞–∫—Å–∏–º—É–º –≤–ø–µ—Ä–µ–¥ (–¥–ª–∏–Ω–Ω–æ–µ)
- **Volume-**: –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–∫–æ—Ä–æ—Ç–∫–æ–µ) / –ú–∞–∫—Å–∏–º—É–º –Ω–∞–∑–∞–¥ (–¥–ª–∏–Ω–Ω–æ–µ)  
- **Play/Pause**: –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
- **Next/Previous**: –ò–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –±—É–¥—É—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π)

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ BT13
1. **–ê–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä**: –ü—Ä–∏ —É–¥–µ—Ä–∂–∞–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
2. **–ë—ã—Å—Ç—Ä—ã–µ —Å–æ–±—ã—Ç–∏—è**: –ò–Ω—Ç–µ—Ä–≤–∞–ª ~150-200–º—Å –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–∞–º–∏
3. **Consumer Control**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç HID Consumer Control, –∞ –Ω–µ –æ–±—ã—á–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É

## üîç –í–∞–∂–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏

### –ü–æ—á–µ–º—É BT13 –ª–µ–≥–∫–æ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ iPhone/Ubuntu
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ **–º–µ–¥–∏–∞-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä** (AVRCP)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–ø—Ä—è–∂–µ–Ω–∏–µ** –±–µ–∑ PIN
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å **Apple HID –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º** (Modalias –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç Apple VID/PID)

### –î–ª—è ESP32 —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç
- ESP32 –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ **HID Host** (–Ω–µ AVRCP –∫–ª–∏–µ–Ω—Ç)
- –ù—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å **Consumer Control Usage Page** (0x0C)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å **–∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä** –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π

## üìù –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ HID —Å–æ–±—ã—Ç–∏–π
```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ BT13
sudo bluetoothctl
> pair 8B:EB:75:4E:65:97
> trust 8B:EB:75:4E:65:97  
> connect 8B:EB:75:4E:65:97

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π
sudo evtest /dev/input/event11
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ HID –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
udevadm info /dev/input/event11

# HID –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
sudo cat /sys/class/hidraw/hidraw*/device/report_descriptor | hexdump -C
```

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

- ‚úÖ **HID –∫–æ–¥—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã** - –≤—Å–µ –∫–Ω–æ–ø–∫–∏ BT13 –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **–ü—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–Ω—è—Ç–µ–Ω** - Consumer Control HID
- ‚úÖ **–ö–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω** - Arduino –∏ ESP-IDF –≤–µ—Ä—Å–∏–∏
- ‚úÖ **–ê–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä —É—á—Ç–µ–Ω** - –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –Ω–∞–∂–∞—Ç–∏–π
- ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Å Apple, —Ç–∞–∫ –∏ —Å Linux

**ESP32 –≥–æ—Ç–æ–≤ –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –∫ BT13 –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π HID Host!** üéâ