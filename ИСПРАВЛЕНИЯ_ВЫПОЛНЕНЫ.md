# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –û–®–ò–ë–û–ö ESP-IDF v5.4.1 –í–´–ü–û–õ–ù–ï–ù–´

## –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

–í—Å–µ –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ `bluetooth2brushless/esp-idf-version` –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å ESP-IDF v5.4.1.

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### 1. ‚ùå ‚Üí ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
```
–ë–´–õ–û:
error: 'ESP_HID_MODE_CLASSIC_BT' undeclared (first use in this function)
ESP_ERROR_CHECK(esp_hid_gap_init(ESP_HID_MODE_CLASSIC_BT));

–ò–°–ü–†–ê–í–õ–ï–ù–û:
ESP_ERROR_CHECK(esp_hid_gap_init(ESP_BT_MODE_CLASSIC_BT));
```

### 2. ‚ùå ‚Üí ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
```
–ë–´–õ–û:
warning: unused variable 'p' [-Wunused-variable]
esp_bt_gap_dev_prop_t *p;

–ò–°–ü–†–ê–í–õ–ï–ù–û:
–£–¥–∞–ª–µ–Ω–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ bt_gap_cb()
```

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –§–∞–π–ª: `main/main.c`

1. **–°—Ç—Ä–æ–∫–∞ 113:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ `esp_hid_gap_init()`
   ```c
   // –ë—ã–ª–æ: ESP_HID_MODE_CLASSIC_BT
   // –°—Ç–∞–ª–æ: ESP_BT_MODE_CLASSIC_BT
   ESP_ERROR_CHECK(esp_hid_gap_init(ESP_BT_MODE_CLASSIC_BT));
   ```

2. **–°—Ç—Ä–æ–∫–∞ 370:** –£–¥–∞–ª–µ–Ω–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
   ```c
   // –ë—ã–ª–æ: esp_bt_gap_dev_prop_t *p;
   // –°—Ç–∞–ª–æ: (—É–¥–∞–ª–µ–Ω–æ)
   ```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

‚úÖ **–í—Å–µ API —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å ESP-IDF v5.4.1:**
- `esp_hid_gap_init()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
- `esp_hidh_dev_t` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö
- `ESP_HIDH_EVENTS` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å–æ–±—ã—Ç–∏–π
- `esp_hidh_event_data_t` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø —Å–æ–±—ã—Ç–∏–π
- `esp_hidh_dev_open()` - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Bluetooth –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- `CONFIG_BT_HID_HOST_ENABLED=y`
- `CONFIG_BT_CLASSIC_ENABLED=y`
- `CONFIG_BTDM_CTRL_MODE_BTDM=y`

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç:

```bash
cd ~/bluetooth2brushless/esp-idf-version
. ~/esp/esp-idf/export.sh
idf.py build
```

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

üéØ **–ü—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫!**

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å:
- –ù–µ–ø–æ–ª–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π ESP-IDF v5.4.1
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –ü—Ä–æ–±–ª–µ–º–∞–º–∏ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

- ‚úÖ –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –¥–ª—è ESP-IDF v5.4.1
- ‚úÖ –í—Å–µ –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ API –æ–±–Ω–æ–≤–ª–µ–Ω –¥–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏
- ‚úÖ –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Å–±–æ—Ä–∫–µ

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 2025-06-09  
**–í–µ—Ä—Å–∏—è ESP-IDF:** v5.4.1  
**–°—Ç–∞—Ç—É—Å:** –ì–û–¢–û–í –ö –ö–û–ú–ü–ò–õ–Ø–¶–ò–ò ‚úÖ